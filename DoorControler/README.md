# 智能门控项目文档

本项目基于Arduino和ESP8266开发板，使用MG996R舵机、AS608指纹模块、MQTT服务器以及基于Node.js的Node-RED网页前端，实现了智能门控系统。

## 项目概述

这个项目旨在创建一个智能门控系统，允许用户通过指纹识别或远程MQTT命令控制门的开关。系统使用ESP8266开发板连接到Wi-Fi网络，并与MQTT服务器通信以接收远程命令。指纹模块用于身份验证，而MG996R舵机用于控制门的开闭。项目还包括蜂鸣器和LED用于指示状态。

## 硬件连接

### 主要组件

- ESP8266开发板

- MG996R舵机

- AS608指纹模块

- MQTT服务器

- LED

- 蜂鸣器

### 连接说明

- 舵机连接到D2引脚。

- LED连接到内置LED引脚。

- 蜂鸣器连接到D8引脚。

- 指纹模块的TX引脚连接到D3引脚，RX引脚连接到D5引脚。

## 代码结构

项目的代码主要包括以下几个部分：

1. 导入所需的库：项目使用了ESP8266WiFi库、PubSubClient库、Servo库和Adafruit_Fingerprint库，以便与Wi-Fi、MQTT服务器、舵机和指纹模块进行通信。

2. 初始化设置：在`setup()`函数中，项目初始化了Wi-Fi连接、MQTT客户端、舵机、LED、蜂鸣器和指纹模块。

3. MQTT连接：`connectMQTTServer()`函数负责连接到MQTT服务器，并订阅了名为"door410"的主题。

4. 控制门的函数：`open_door()`函数用于开门，`rollback()`函数用于回正门的位置。

5. MQTT回调函数：`callback()`函数处理从MQTT服务器接收到的命令，并根据命令执行相应的操作。

6. 指纹模块操作：`getFingerprintID()`函数用于识别指纹并执行相应的操作。

7. 辅助函数：`IdentfyPass()`和`IdentfyNotPass()`函数用于处理身份验证结果的可视和声音反馈。

8. 主循环：`loop()`函数主要用于保持与MQTT服务器的连接，并定期执行指纹识别。

## 如何使用

1. 确保硬件连接正确。

2. 在代码中配置Wi-Fi SSID和密码、MQTT服务器地址和订阅主题。

3. 将代码上传到ESP8266开发板。

4. 打开串口监视器，查看系统的状态和调试信息。

5. 指纹识别部分：将已注册的指纹与系统匹配，如果匹配成功，门将打开。

6. 远程控制：通过MQTT发送命令到名为"door410"的主题，可以远程控制门的开闭。

7. 观察LED和蜂鸣器的状态，以获取反馈信息。

## 本项目提供了基本示例，可根据实际需求进行扩展和改进。

